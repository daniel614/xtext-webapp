/*
 * generated by Xtext 2.14.0
 */
package org.xtext.example.wappm.tests

import com.google.inject.Inject
import org.eclipse.xtext.testing.InjectWith
import org.eclipse.xtext.testing.XtextRunner
import org.eclipse.xtext.testing.util.ParseHelper
import org.junit.Assert
import org.junit.Test
import org.junit.runner.RunWith
import org.xtext.example.wappm.wappm.WebModel
import org.eclipse.xtext.testing.validation.ValidationTestHelper
import org.xtext.example.wappm.wappm.WappmPackage

@RunWith(XtextRunner)
@InjectWith(WappmInjectorProvider)
class WappmParsingTest {
	@Inject
	ParseHelper<WebModel> parser
	
	@Inject
	ValidationTestHelper validator
	
	@Test
	def void shouldValidateModel() {
		val model = parser.parse('''
			webapp TestApp {
				hypertext TestHyper {
					detail TestDetail uses SomeClass {
						path /test/:test
						links {
							link {
								page TestIndex
							}
						}
					}
					index TestIndex uses TestClass {
						path /test
					}
				}
				
				content TestContent {
					class TestClass {
						attr SampleAttr : String
						uniqueIdentifier SampleAttr
					}
					class SomeClass {
						attr SampleAttr2 : String
						uniqueIdentifier SampleAttr2
					}
				}
			}
		''')
		
		validator.assertNoErrors(model)
		validator.assertNoWarnings(model, WappmPackage.Literals.WEB_MODEL)
	}
	
		@Test
	def void shouldOutputWarningAboutCapitalLetterWebModel() {
		val model = parser.parse('''
			webapp testApp {
				hypertext TestHyper {
					detail TestDetail uses SomeClass {
						path /test/:test
						links {
							link {
								page TestIndex
							}
						}
					}
					index TestIndex uses TestClass {
						path /test
					}
				}
				
				content TestContent {
					class TestClass {
						attr SampleAttr : String
						uniqueIdentifier SampleAttr
					}
					class SomeClass {
						attr SampleAttr2 : String
						uniqueIdentifier SampleAttr2
					}
				}
			}
		''')
		
		validator.assertWarning(model, WappmPackage.Literals.WEB_MODEL, "Name should start with a capital letter")
	}
}
